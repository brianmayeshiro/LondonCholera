<head>
<title>Plotly Test</title>

<style>
ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #333;
}

li {
    float: left;
}

li a {
    display: block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}

li a:hover {
    background-color: #111;
}
</style>
<body>

<ul>
  <li><a class="active" href="index.html">Home</a></li>
  <li><a href="about.html">About</a></li>
</ul>
<script src="plotly-latest.min.js"></script>



<!--

    <div id="thecontrolcolumn" style="width:20%; height:400px; float: left; background-color:rgb(128, 215, 236);">
        <P><center><font face="Arial">Controls</font></center></P>
        <div >
            <center><input id="mySlider" type="range" min="1" max="100" value="50" ></center>
        </div>
        <div>
            <center><input id="myInput" value=0></center>
        </div>
        <div >
            <center><button id="myButton"> Add Data Point</button></center>
        </div>
        <div >
            <center><button id="myButton2">Add Trace</button></center>
        </div>
        <div >
            <center><button id="myButton3">Disco</button></center>
        </div>
        <div>
            <center>Check This:<input type="checkbox" id="myCheck"></center>
        </div>
    </div>
-->
    <div id="thevizcolumn" style="width:80%; height:400px; float: left; background-color:rgb(247, 200, 224);">
      <p><center><font face="Arial">Visualization</font></center></p>
      <div style="width:50%; height:400px; float: left">
      <div id="table" style="width:100%;height:300px;" ></div>
      </div>
    </div>
    <div id="thevizcolumn" style="width:80%; height:400px; float: left; background-color:rgb(247, 200, 224);">
      <div style="width:50%; height:400px; float: left">
      <div id="choleraDeaths" style="width:100%;height:300px;" >
      </div>
    </div>
    <div id="thevizcolumn" style="width:80%; height:400px; float: left; background-color:rgb(247, 200, 224);">
      <div style="width:50%; height:400px; float: left">
      <div id="naplesCholeraAgeSex" style="width:100%;height:300px;" >
      </div>
    </div>

<script>
Plotly.d3.tsv("https://raw.githubusercontent.com/brianmayeshiro/LondonCholera/master/choleraDeaths.tsv", function(err, rows){

  function unpack(rows, key) {
  return rows.map(function(row) { return row[key]; });
  }

  var headerNames = Plotly.d3.keys(rows[0]);

  var headerValues = [];
  var cellValues = [];
  var totalDeaths = [];

  for (i = 0; i < headerNames.length; i++) {
    headerValue = [headerNames[i]];
    headerValues[i] = headerValue;
    cellValue = unpack(rows, headerNames[i]);
    cellValues[i] = cellValue;
  }

  headerValues[headerValues.length] = "Attacks and Deaths";
  // clean date
  for (i = 0; i < cellValues[1].length; i++) {
  var dateValue = cellValues[1][i].split(' ')[0]
  cellValues[1][i] = dateValue
  totalDeaths[i] = +cellValues[1][i] + +cellValues[2][i];
  }

//console.log(totalDeaths);

var data = [{
  type: 'table',
  columnwidth: [200,500,600,600,400,400,600,600,600],
  columnorder: [0,1,2,3,4,5,6,7,8,9],
  header: {
    values: headerValues,
    align: "center",
    line: {width: 1, color: 'rgb(50, 50, 50)'},
    fill: {color: ['rgb(235, 100, 230)']},
    font: {family: "Arial", size: 11, color: "white"}
  },
  cells: {
    values: [cellValues[0], cellValues[1], cellValues[2], totalDeaths],
    align: ["center", "center"],
    line: {color: "black", width: 1},
    fill: {color: ['rgba(228, 222, 249, 0.65)','rgb(235, 193, 238)', 'rgba(228, 222, 249, 0.65)']},
    font: {family: "Arial", size: 10, color: ["black"]}
  }
}]

var layout = {
  title: "Date vs. Deaths"
}

Plotly.plot('table', data, layout);
});

    Plotly.d3.tsv("https://raw.githubusercontent.com/brianmayeshiro/LondonCholera/master/choleraDeaths.tsv", function(allRows) {
        console.log(allRows);

        var layout = {
            title: "Date vs. Number of attacks and deaths"
        };

        var x = [], y = [], deaths = [], totalAttacks = [], totalDeaths = [];

        for (var i=0; i<allRows.length; i++) {
        		row = allRows[i];
        		x.push( row['Date'] );
        		y.push( row['Attack'] );
            deaths.push(row['Death']);
            if (totalAttacks.length != 0) {
              totalAttacks.push(+row['Attack'] + +totalAttacks[i - 1]);
            }
            else {
              totalAttacks.push(row['Attack']);
            }

            if (totalDeaths.length != 0) {
              totalDeaths.push(+row['Death'] + +totalDeaths[i - 1]);
            } else {
              totalDeaths.push(row['Death']);
            }

            //console.log(row['Date']);
            //console.log(row['Attack']);
        }

        var trace0 = [{
            x: x,
            y: y,
            type: 'line',
            name: 'Attacks',
            //text: ['SAMOA','TONGA','TOKELAU','AOTEROA'],
        }];

        Plotly.newPlot('choleraDeaths', trace0, layout);

        var trace1 = [{
            x: x,
            y: deaths,
            type: 'line',
            name: 'Deaths',
            //text: ['SAMOA','TONGA','TOKELAU','AOTEROA'],

            marker: {
                color: 'rgb(219, 64, 82)',
                size: 12
            }
        }];

        Plotly.plot(choleraDeaths, trace1);

        var trace2 = [{
          x: x,
          y: totalAttacks,
          type: 'line',
          name: 'total attacks up to this day'

        }];

        Plotly.plot(choleraDeaths, trace2);

        var trace3 = [{
          x: x,
          y: totalDeaths,
          type: 'line',
          name: 'total deaths up to this day'

        }];

        Plotly.plot(choleraDeaths, trace3);
    });

    Plotly.d3.tsv("https://raw.githubusercontent.com/brianmayeshiro/LondonCholera/master/naplesCholeraAgeSexData.tsv", function(allRows) {
        console.log(allRows);

        var layout = {
            title: "Cholera Age Sex"
        };

        var x = [], y = [];

        for (var i=0; i<allRows.length; i++) {
        		row = allRows[i];
        		x.push( row['age'] );
        		y.push( row['male'] );
            //console.log(row['Date']);
            //console.log(row['Attack']);
        }

        var trace0 = [{
            x: x,
            y: y,
            type: 'line',
            mode: 'markers',
            name: 'Zeroth Trace',
            //text: ['SAMOA','TONGA','TOKELAU','AOTEROA'],

            marker: {
                color: 'rgb(219, 64, 82)',
                size: 12
            }
        }];

        Plotly.newPlot('naplesCholeraAgeSex', trace0, layout);
    });

    var trace0 = {
        x: [1, 2, 3, 4],
        y: [10, 15, 13, 17],
        type: 'scatter',
        mode: 'markers',
        name: 'Zeroth Trace',
        text: ['SAMOA','TONGA','TOKELAU','AOTEROA'],

        marker: {
            color: 'rgb(219, 64, 82)',
            size: 12
        }
    };
    var trace1 = {
        x: [1, 2, 3, 4],
        y: [16, 5, 11, 9],
        type: 'scatter',
        name: 'First Trace'
    };
    data1 = [trace0, trace1];

    var trace2 = {
        x: ["Star Wars", "Star Trek", "Babylon 5", "Battlestar"],
        y: [16, 5, 11, 9],
        type: 'bar'
    }
    data2 = [trace2];

   plot1Div = document.getElementById('plot1');
   plot2Div = document.getElementById('plot2');
   var layout = {
       title: "Chart 1"
   };
   var layout2 = {
       title: "Chart 2"
   }
	//var myChart1=Plotly.plot( plot1Div, data1, layout );
    //var myChart2=Plotly.plot( plot2Div, data2, layout2 );

/*
    var button = document.getElementById("myButton");
    var button2 = document.getElementById("myButton2");
    var button3 = document.getElementById("myButton3");
    var slider = document.getElementById("mySlider");
    var input = document.getElementById("myInput");
    var check = document.getElementById("myCheck");
    check.checked=true;

    input.onfocus = function(){
        input.value="0";
    }

    check.onclick = function(){
        if (check.checked == true){
            trace0.visible = true;
        } else {
            trace0.visible = false;
        }
        Plotly.react(plot1Div,
        data1, 0);   // Zero here refers to the zeroth plot trace
    }


    updateChart = function(value) {
        // Change the value in one of the data arrays
        var arry = trace0.y;
        arry[0]=value

        // Update the plot to reflect the new data change.
        Plotly.newPlot(plot1Div,
        data1, 0);   // Zero here refers to the zeroth plot trace
    }
    input.onkeyup = function() {
        slider.value = input.value;
        updateChart(input.value);
    }
    slider.oninput = function() {
        input.value = slider.value;
        updateChart(slider.value);
    }

    // Add one additional data value to trace 0
    button.onclick = function(){

        // Add a data value to the data array

        var arrx = trace0.x;
        var arry = trace0.y;

        arrx.push(arrx.length);
        arry.push(Math.random()*10);

        // Update the plot to reflect the new data change.
        Plotly.newPlot(plot1Div, data1, 0);   // Zero here refers to the zeroth plot trace
    }

    // When you click on Button 2 it adds a new trace to the plot.
    button2.onclick = function(){

        var arrx = [1,2,3,4];   // X axis values
        var arry = [0,0,0,0];   // Y axis values

        var trace = {
            x: arrx,
            y: arry
        }
        var data = [trace];

        // Put some random numbers into the trace.
        for (i in arrx){
            arry[i] = Math.random()*15;
        }

        // Add the data to the plot.
        Plotly.plot( plot1Div, data);
    }

    // Change the color of trace 0 to some random color
    button3.onclick = function(){
        var updateColor = {
            marker: {
                color: 'rgb(250, 0, 0)'
            }
        }

        var aRandomColor = "rgb("+Math.random()*255+","+Math.random()*255+","+Math.random()*255+")";
        updateColor.marker.color = aRandomColor;
        Plotly.restyle(plot1Div, updateColor,0);
    }
    */
</script>

</body>
</head>
